<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>修改用户信息</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/css/bootstrap-icons.css">
    <link rel="stylesheet" href="/static/css/login.css">
</head>
<body>
    <div class="toast-container"></div>
    <div class="page-wrapper">
        <div class="login-container">
            <div class="login-header">
                <h1><i class="bi bi-pencil-square me-2"></i>修改信息</h1>
                <p>修改用户名、邮箱或密码</p>
            </div>
            
            <form method="POST" action="{{ url_for('edit_account') }}">
                <div class="form-group">
                    <label for="username"><i class="bi bi-person me-1"></i>用户名</label>
                    <input type="text" class="form-control" id="username" name="username" placeholder="请输入新的用户名(留空表示不修改)" value="{{ session.get('username', '') }}">
                </div>
                <div class="form-group">
                    <label for="email"><i class="bi bi-envelope me-1"></i>邮箱</label>
                    <input type="email" class="form-control" id="email" name="email" placeholder="请输入新的邮箱(留空表示不修改)" value="{{ session.get('email', '') }}">
                </div>
                <div class="form-group">
                    <label for="password"><i class="bi bi-lock me-1"></i>密码</label>
                    <input type="password" class="form-control" id="password" name="password" placeholder="请输入新密码(留空表示不修改)">
                </div>
                <button type="submit" class="btn btn-login"><i class="bi bi-check2-circle me-2"></i>确认修改</button>
            </form>
            
            <div class="links">
                <a href="{{ url_for('problems') }}"><i class="bi bi-arrow-left me-1"></i>返回题目列表</a>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>&copy; 2025 BCMOJ. Released under the <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a>. | <a href="/about">关于我们</a></p>
    </div>

    <script src="/static/js/popper.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script>
    function showToast(message, type = 'info', title = '系统通知') {
        const toastContainer = document.querySelector('.toast-container');
        const toastId = 'toast-' + Date.now();
        let icon = 'bi-info-circle';
        if (type === 'success') icon = 'bi-check-circle';
        else if (type === 'error') icon = 'bi-x-circle';
        else if (type === 'warning') icon = 'bi-exclamation-circle';
        const toastEl = document.createElement('div');
        toastEl.className = `toast toast-${type}`;
        toastEl.id = toastId;
        toastEl.setAttribute('role', 'alert');
        toastEl.setAttribute('aria-live', 'assertive');
        toastEl.setAttribute('aria-atomic', 'true');
        toastEl.innerHTML = `
            <div class="toast-header">
                <i class="bi ${icon} me-2"></i>
                <strong class="me-auto">${title}</strong>
                <small>刚刚</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                ${message}
            </div>
        `;
        toastContainer.appendChild(toastEl);
        const toast = new bootstrap.Toast(toastEl, { delay: 5000 });
        toast.show();
        toastEl.addEventListener('hidden.bs.toast', function () { toastEl.remove(); });
    }

    document.addEventListener('DOMContentLoaded', function () {
        const flashMessages = {{ get_flashed_messages(with_categories=true) | tojson }};
        flashMessages.forEach(([category, message]) => {
            showToast(
                message,
                category,
                category === 'success' ? '操作成功' :
                category === 'error' ? '发生错误' :
                category === 'warning' ? '警告' : '系统通知'
            );
        });
    });
    </script>
</body>
</html>
