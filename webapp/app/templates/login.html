<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户登录</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/css/bootstrap-icons.css">
    <link rel="stylesheet" href="/static/css/login.css">
</head>
<body>
    <div class="toast-container"></div>
    <div class="page-wrapper">
        <div class="login-container">
            <div class="login-header">
                <h1><i class="bi bi-box-arrow-in-right me-2"></i>用户登录</h1>
                <p>欢迎回到BCMOJ</p>
            </div>
            
            <form method="POST" action="{{ url_for('login') }}">
                <div class="form-group">
                    <label for="username_or_email"><i class="bi bi-person me-1"></i>用户名或邮箱</label>
                    <input type="text" class="form-control" id="username_or_email" name="username_or_email" required placeholder="请输入用户名或邮箱">
                </div>
                <div class="form-group">
                    <label for="password"><i class="bi bi-lock me-1"></i>密码</label>
                    <input type="password" class="form-control" id="password" name="password" required placeholder="请输入密码">
                </div>
                <button type="submit" class="btn btn-login"><i class="bi bi-box-arrow-in-right me-2"></i>登录</button>
            </form>
            <div class="links">
                <a href="{{ url_for('register') }}"><i class="bi bi-person-plus me-1"></i>注册新账号</a>
                <a href="{{ url_for('forgot_password') }}"><i class="bi bi-question-circle me-1"></i>忘记密码?</a>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>&copy; 2025 BCMOJ. Released under the <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a>. | <a href="/about">关于我们</a></p>
    </div>

    <script src="/static/js/popper.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script>
    function showToast(message, type = 'info', title = '系统通知') {
        const toastContainer = document.querySelector('.toast-container');
        const toastId = 'toast-' + Date.now();
        let icon = 'bi-info-circle';
        if (type === 'success') icon = 'bi-check-circle';
        else if (type === 'error') icon = 'bi-x-circle';
        else if (type === 'warning') icon = 'bi-exclamation-circle';
        const toastEl = document.createElement('div');
        toastEl.className = `toast toast-${type}`;
        toastEl.id = toastId;
        toastEl.setAttribute('role', 'alert');
        toastEl.setAttribute('aria-live', 'assertive');
        toastEl.setAttribute('aria-atomic', 'true');
        toastEl.innerHTML = `
            <div class="toast-header">
                <i class="bi ${icon} me-2"></i>
                <strong class="me-auto">${title}</strong>
                <small>刚刚</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                ${message}
            </div>
        `;
        toastContainer.appendChild(toastEl);
        const toast = new bootstrap.Toast(toastEl, {
            delay: 5000
        });
        toast.show();
        toastEl.addEventListener('hidden.bs.toast', function () {
            toastEl.remove();
        });
    }
    document.addEventListener('DOMContentLoaded', function () {
        const flashMessages = {{ get_flashed_messages(with_categories=true) | tojson }};
        flashMessages.forEach(([category, message]) => {
            showToast(
                message,
                category,
                category === 'success' ? '操作成功' :
                category === 'error' ? '发生错误' :
                category === 'warning' ? '警告' : '系统通知'
            );
        });
    });
</script>
</body>
</html>